* introduction
- http://www.jenapolis.de/2012/05/prof-dr-herbert-gross-ist-neuer-professor-fuer-theorie-optischer-systeme-der-uni-jena/
  - Prof. Gross Der 57-J채hrige hat mehr als drei Jahrzehnte f체r das
    Unternehmen Zeiss gearbeitet, bevor er jetzt den Schritt aus der
    Wirtschaft in die Wissenschaft machte.
  - Dass der erfahrene Wissenschaftler, der seit Mitte der 1990er
    Jahre die zentrale Abteilung f체r Optikdesign und Simulation bei
    Zeiss geleitet hat, dem Ruf der Friedrich-Schiller-Universit채t

- english slides are on http://www.iap.uni-jena.de/teaching-lightBox-1-lectureID-23.html
- z ist optische achse

** parameter
 - single step
 - surface and transition
 - wenn man ein system mit n flaechen hat, dann ist n immer die
   bildebene und die objektebene hat index 0
 - erster abstand hat index 0 und n-ter abstand wird nicht mehr
   benoetigt -- das findet er nicht masslos clever
 - ray path has fixed sequence 0,1, .. (n-1)
 - in anderen programmen ist das zum teil anders
 - 7 leute haben zemax am arbeitsplatz. am iap gibts nur wenige
 - professor gross wird neues zemax befassen
 - folien gibts auf iap seite
 - notwendige daten
   - system surfaces (radius)
   - distances and parameters (length, material)
   - stop surfaces
   - wavelengths
   - aperture
   - field points
 - optionale inputs
   - finite diameter
   - vignetting factors
   - decenter and tilt
   - coordinate reference
   - weighting factors for wavelengths and field points
   - multi configurations
   - ...

- f2 druecken um im zellen modus zahlen zu editieren
- skalieren von systemen (patent daten analysieren) .. werden immer
  auf brennweite 100 normiert (scale factor, wellenlaenge und beugung
  werden nicht veraendert, asphaerenkonstanten werden intern
  veraendert)
- kataloglinsen einsetzen und umdrehen

- was man an einer flaeche festlegen kann
  - mit rechter maus auf zelle druecken Surface properties
  - kugel, asphaere, kegelschnitt, toroidal lens (cylinder lens),
    ideal lens, coordinate break (pseudoflaeche an der koordinaten
    transformiert werden)
  - linsenschnitt farbig hervorheben (z.b. kaufkomponenten gruen)
  - linsen vorruebergehend inaktiv schalten

** solves
 - chief ray angle (hauptstrahlwinkel z.b. bildraum telezentrisch)
 - marginal ray normal
 - aplanatic surface
 - element power
 - marginal ray height (randstrahl hoehe im bild 0, frueher hat man
   die letzte flaeche immer so gekruemmt, dass die in der bildebene
   liegt)
 - pickup
   - holt sich wert des radius von woanders, z.b. bei symmetrischen
     systemen oder wenn baulaenge festgelegt ist

** 3d geometrie
- man muss pseudoflaeche einfuehren
- komischerweise kann es keine verschiebung in z aber das kann man
  ueber die dicke machen
- alle moeglichen drehwinkel sind moeglich  
- gruppe kippen oder zentrieren (z.b. ganzes objektiv oder fuer
  toleranzen)
- faltspiegel
  - erst koordinatensystem in spiegel drehen
  - dann spiegelwirkung
  - dann nochmal spiegel koordinatensystem
- surface properties / tilt-decenter
  - wenn vor und hinter der flaeche +20 grad und -20 grad wird flaeche
    gekippt, bisschen tueckisch
- zeigt wie linsengruppe um 5mm in y verschoben wird
  - insert, coordinatee break
  - kann layout nicht mehr malen (nicht rotationssymmetrisch)
  - stattdessen layout 3d, zeigt auch linien der randzylinder (lens
    edges)
  - in coordinate break linie decenter y auf 5mm setzen
  - hinter der letzten flaeche einen coordinate break einsetzen y auf
    -5mm
  - update in layout 3d druecken
  - pickup in zweiten coordinaten break setzen mit scale factor -1,
    bei dicken muss man offset machen
  - dann steht ein P neben den wert in der tabelle
- flaeche um 10 grad kippen, dahinter um -10 grad
- linke maustaste fenster in 3d layout um zu zoomen, unzoom
- window clone, und dann flaeche wieder zurueckkippen, wenn man nicht
  update in beiden drueckt, kann man vergleichen. overlay geht auch
- heutzutage nutzt man kippen zum korrigieren (z.b. headmounted
  device)
- heute bis 12:30

* definition of aperture and field
- lichtkegel mit dem system licht transportiert (mikroskopiker: je
  groesser oeffnungswinkel, mehr energie, mehr information; man
  verlaesst aber paraxial bereich und die performance wird schlechter)
- randstrahlen begrenzen den kegel
- groesse vom objektpunkt macht kegel windschief, mittlerer strahl ist
  hauptstrahl
- abbildbare flaeche * winkel ist lagrange invariante
- transportmass, dass das optiksystem korrigiert
- unterschied fotographie (coma, verzeichnung, astigmatismus),
  mikroskopie
- lithographie objektiv hat grosses feld und grosse winkel (aber nur
  eine wellenlaenge)
- beugung an apertur bewirkt airy verteilung
- man braucht also nicht besser optimieren als die airy verteilung
- bei einzellinse sin u \approx 0.05 noch beugungsbegrenzt
- achromat bis na=0.1 immer noch beugungsbegrenzt
- darueber muss man mehr aufwand treiben
- f-zahl F#=f'/Dex
- fuer kleine aperturen F#=1/(2 NA)
- stop position 
- hauptstrahl geht durch die mitte dieser blendenebene (vom rand des
  objekts)
- randstrahl geht durch die kante (von mitte des objekts)
- es ist nicht immer klar wo die blende ist, verallgemeinert zu pupille
- physische blende in beide raeume abbilden nach objekt
  (eintrittspupille) und bildraum (austrittspupille)
- sind alle zueinander konjugiert, d.h. gehen durch abbildung
  auseinander hervor
- pupille legt den lichtstrom und die aufloesung fest, perspektive
- wenn man zwei systeme zusammenbaut, muss man die pupillen matchen
  (nicht nur die sehfelder)
- pupille das auges (3.2 mm hinter der cornea), okular muss eine
  entsprechende pupille haben
- wenn nutzer eine brille traegt noch schwieriger
- d.h. okular muss pupille mind. 20mm hinter der linse haben
- sonst schaut man wie in ein schluesselloch und das feld schrumpft
  sehr schnell zusammen
- lage der eintrittspupille mit hauptstrahl, durchmesser mit
  randstrahl

- paraxiale und reale oeffnung muessen nicht identisch sein (bei
  grossen aberrationen)
- floating aperture by stop size, macht den kegel immer weiter auf,
  bis er an irgendeinen rand stoesst
- telezentrisch: hauptstrahl parallel zur optischen axe -> pupille ist
  im unendlichen, dass muss man zemax explizit setzen, da ist auch
  egal wo man den stop hinsetzt
- afocal bild im unendlichen ist auch ein sonderfall
 - dann macht spot diagram im bildraum keinen sinn. man muss das dann
   im winkelraum machen. in zemax heisst das cosine space
 - da braucht man planwelle als bezug

- field data
 - man kann bis zu 12 feld positionen definieren
 - das ist sehr wenig fuer anamorphie
 - vignettierungsfaktor (am rand ist der kegel kleiner, z.b. 70%)

- suppress frame, damit mehr platz fuer das diagramm ist
- in etwa spiegelsymmetrisch hilft unheimlich um asymmetrische fehler
  zu korrigieren
- 2d layout
- hauptwellenlaenge ist meist die zweite
- lasersysteme sind oft sehr gestreckt. dafuer kann man eine
  anamorphotische darstellung machen (y-stretch)
- analysis layout shaded model
- mit gedrueckter maus das system drehen
- opacity
- strahl ring ist am angenehmsten
- durchgeschnittenes objektiv (draw section)

- materialien auf naechste woche verschoben
- zwei uebungen hat er upgeloaded

* scheme of raytrace
- radius vorzeichen wird genutzt, um die richtige surface zu ermitteln
- spiegel: medium ist mirror (ab da alle dicken negativ, wechselt von
  rechts in linkssystem) -> sehr gewoehnungsbeduerftig
- \r'=\D_H \R_H \F \R_V \D_V \F
- equation of surface 2. order
- konstanten enthalten flaechenparameter
- c = 1/R kruemmung (planflaeche stetig)
- zwei schiefe dicke 

- probleme:
 - linse mit negativer randdicke, da meckert siemens nicht
 - totalreflexion, da meckert zemax und hoert mit raytrace auf
 - physisch linse nicht getroffen (delete vignetting, damit die
strahlen gestoppt werden)

- ebener strahlfaecher (ray fan)
- pupillenflaeche erfassen durch sampling in der pupille (ray cone)
 - polar grid
 - cartesian (rand ist schlecht)
 - isoenergetic circular (ist ganz gut, vielleicht fuer mma?)
 - hexgonal (erfasst rand ganz gut)
 - statistical (gibts mittlerweile besseres: walton statistik ohne
   loecher)

- raytrace fuer einen strahl (analysis-calculations-raytrace)
- zemax macht alles real und paraxial
- start koordinaten H (objekt)
- pupille P 

- system-wavelength (oder wav button)
- 24 wellenlaengen eingeben
- standard wellenlaengen sind auch da
- photographie: gelbes natrium d,f (blau),c (rot)
- mikroskopie F' e C' (mehr fuers auge optimiert)
- wenn man die wellenlaengen so waehlt, dass er keine brechzahlen hat,
  dann meckert er

* 2 aufgaben:
- spiegeltreppe, hinter dem letzten spiegel objektiv, aufgaben was
  angeschaut werden soll
  - editor-merrit function, optimiere fuer effl, weight 1, value 200
- telezentrisches 4f system, beste bildebene, wann ist es
  beugungsbegrenzt

* sweatt modell 
  - diffraktiv optisches element
  - unwrappen und mit hoher brechzahl (10000) als asphaere simulieren

* grin media
  - kann zemax gut
  - split-step runge kutta
  - braucht viel rechenzeit

* technische optik
  - brechzahl als funktion der koordinaten
  - gradienten nur in z haben ueberragende eigenschaften
  - axiale gradienten: 
    - brechkraft einstrahlwinkelabhaengig
  - in letzter zeit viel ueber geodaetische linsen
    - gradienten herstellen ist ein alptraum
  - problem mit antireflexbeschichtung bei gekruemmten gradientenindex
    oberflaechen
  - gradium linsen (zemax wegweisend)
    - rein axialer gradient
    - es gibt eine firma, die solche blanks verkauft, nicht ueber
      diffusion ins volumen, sondern sehr viele slices werden
      aufeinandergesprengt und thermalisiert -> sehr viel genauere
      brechzahlprofile
  - grintech fraunhofer iof
    - macht sehr praezise axiale brechzahlprofile
    - quadratische brechzahlfunktion (light confinement wie bei
      fasern)
    - lange linsen muessen auch noch korrigierenden term 4. ordnung
      haben, um oeffnungsfehler in den griff zu kriegen
    - man kann das nicht einfach so von der seite anfraesen

* praxis: eingabe der gradienten
  - chapter 11, surface types
  - gradient1 ist radiales medium mit quadratischen und linearem term
  - Delta t ist die schrittweite
  - Nr1 ist quadratisch, setzen auf -.1

  - gerade asphaere
    - scheitelaradius 100
    - hintere flaeche eben
    - konische konstante 2
    - a^4 term -.005 oder so
    - in der mitte flach, am rand staerker geneigt
    - surface sec
      - punktzahlen sind immer 2potenz+1, damit man die optische achse
        erwischt
    - negative 6. ordnung ergibt einen wendepunkt (mag die fertigung
      ueberhaupt nicht, weil das werkzeug abhebt)
    - sec crosssection 
    - taktile messung ist schlecht (schleifspur auf linse und man
      trifft mitte nicht genau), besser computer generated hologram
      und interferometrie
    - C-z 4.ordnung und curvature variable
    - editor merit function, spot radius (null ist gut) 
      - ist 5 groessenordnungen besser geworden
      - viel besser als airy (na ist relativ klein, daher kann man 
        muss man 3te ordnung bildfehler korrigieren, was wir hier
        machen)
      - jetzt muss man wieder raus

  - tools->catalogs->glass
    - schott, nBK7 (weil bleifrei)
    - brechzahl von 300nm bis 2.5um

  - general data (Gen), reiter glass catalog
    - voreinstellung immer schott
    - aber man kann noch mehr zulassen

  - analysis->glass index->dispersion diagram

  - floating glass
  - model glass
    - brechzahl, abbe zahl, anomale teildisperision
    - damit kann man stetig optimieren
    - setze n auf 3 und C-z nimmt dann das hoechst brechende (n=2.02
      schott)

- cardinal elemente sind paraxial definierte beschreibungsparameter
  - brennweite (wenn man parallel reinkommt)
  - es gibt die hauptebene. fiktive wo die ganze strahlumlenkung
    stattfindet
  - brennweite wird nicht zum scheitel, sondern zur hauptebene
    gemessen die back focal plane, er mag den ausdruck ueberhaupt
    nicht)
  - scheitel bis brennpunkt ist die schnittweite (in englisch ist das
  - je nach form charakteristische lagen (e.g. bei n=1.5 und
    symmetrisch 1/3 1/3 1/3)
  - bei konvex-plan eine identisch mit scheitel
  - linsendurchbiegung (konstante brechkraft, randflaeche/mittenflaeche)
     - durchbiegen ist eine der allerwichtigsten schritte bei der
       optimierung
     - brechungsgesetz ist nichtlinear -> bildfehler treten bei
       grossen einfallswinkeln auf. 
     - je nachdem, wie man die linse durchbiegt, bekommt man ganz
       unterschiedliche winkel
     - am besten ist gleichmaessige verteilung

   - coma strahlen sind die, die am meisten stoeren (um hauptstrahl an
     den rand der pupille)

- fuer sammellinse s' negativ, s ist positiv
- zuerst ideale linse
- dicke linsen (z.b. plankonvexlinse nehmen und die brechzahl auf 2
  setzen)
- dann objektiv durchbiegen

- vignettierung: beschnitt des strahlbueschels, wenn man schraeg durch
  system durchgeht
  - relativ komplexe beugungsfiguren, in z gestaffelt

- analysis->calculations->cardinal points  
  - fuer komplettsystem
  - knotenebenen (wo winkel gleich bleibt)
  - doppel gauss objektiv
    - erste linse (settings 1..2) 

- analysis->calculations->raytrace 
  - durchrechnung von einem einzigen strahl
  - feldpunkt und relative pupillenkoordinate
  - durchstoss punkte
  - richtungen der flaechennormale
  - wellenaberrationen
  - flaeche 7 hat starke umlenkung fuer randstrahl, flaeche 10 fast
    konzentrisch
  - linsenschnitt
  - vermutlich projektion der y koordinaten 

- aufmass durchmesser
- zeisswerk in goettingen, bildweiche, bertrand optik
  - einsatz aus kunststoff mit spanten beim prototyp ging das licht
    nicht durch
  - werksleiter hat das dann weggesaegt

- fertigteilkataloge
  - tools->catalogs->lens catalog
  - asphericon
  - melles griot, edmund, linos, newport, thorlabs
  - suche von 95 bis 105, pupillen durchmesser 40..45
  - einschraenkung der elemente (achromat als doublett)
  - search
  - efl ist brennweite, epd pupil diameter
  - insert nach flaeche 11
  - hat quarzlinse gewaehlt
  - jetzt hat zemax irgendwas kaputtgemacht

- asphericon ist fast weltweit die einzige firma mit asphaerischen
  zylinderlinsen
- load ersetzt das objektiv
- zemax kann kein anamorphotisches spot diagram
- bei 500 statt 780nm mit nachfokussieren ist sie nur gerade mal so beugungsbegrenzt
- lutz leine vergibt accounts


* asphaere um laserdiode zu kollimieren
  - 0.4 NA, radius 4mm -> 10mm brennweite
  - grosse streuung
  - ueberpruefe dass alle asphaeren konstanten vorhanden sind
  - wellenlaenge einrichten 650nm (fokus kuerzer als bei 780nm,
    quickfocus)
  - performance ist nicht mehr perfekt fuer 650nm aber gut genug (weil
    sie fuer deutlich hoehere oeffnungen korrigiert ist)
  - markieren und reverse, erste flaeche mitnehmen 
  - apodisation uniform
  - 1:4 anamorphotische form
  - fast axis ist y schnitt
  - x schnitt soll kleine aperture haben
  - bei field kuenstliche vignettierung von 75% im x-schnitt einbauen
    (man koennte auch auf die erste flaeche der linse eine elliptische
    blende setzen, aber dann verliert man viele strahlen)
  - fenster clonen und 90 grad um z achse drehen, im y schnitt nur y
    strahlen
  - man koennte den front abstand nachoptimieren fuer die geringer
    apertur
  - strahlquerschnitt ist jetzt elliptisch
  - 2mm dahinter eine zylinderlinse (im prinzip ist sie falschrum
    gekruemmte seite sollte richtung paralleln strahl gehen)
  - ein paar pseudoflaechen einfuegen (weil das beim nachtraegliche
    einfuegen immer abstaende ueberschreibt)
  - suche toroidal von -100 bis -10mm (im beispiel hat er -25 und 100
    gemacht, dann sind die winkel klein genug. kuerzere brennweiten
    liefern kleinere baulaenge, sind aber schwieriger zu optimieren
    (wegen hoeheren winkeln))
  - zylinderlinse wirkt im falschen schnitt
  - flaeche 3 und 4, tools, tilt and decenter elements, tilt in z um
    90 grad, fuegt automatisch zwei pseudoflaechen mit koordinate
    break ein
  - jetzt eine +100 zylinderlinse (mindestdurchmesser 8mm) mit
    planflaeche nach vorn bei ungefaehr 75mm
  - den abstand 75mm auf variabel setzen, merrit entweder wellenfront
    eben (dann muesste man explizit sagen, dass bildraum afokal ist)
    oder winkelaufspreizung soll verschinden (letzteres ist einfacher)
    optimieren bringt 67mm und ist faktor 10 besser
  - analysis ..., kreisfoermigkeit des querschnitts ueberpruefen,
    leichte elliptizitaet bleibt uebrig: 4.18 zu 4.03, weil
    verhaeltnis der brennweiten nicht exakt 1:4 war
  - im spotdiagramm die richtungscosinus anzeigen (restfehler von
    0.1mrad im kollimierten strahl)
  - mit brennweite 40 in faser kollimieren
  - suche sphaerisch 35..45
  - 41mm mit 11mm durchmesser, sieht aber uebel aus, ist fast
    randscharf
  - spot auf der faser ist 3 mal beugungsbegrenzt
  - mit achromat fuer die letzte linse wird es gleich besser
  - zernike koeffizienten zeigen wie es verbessert werden kann
  - die diagonale wurde jetzt nicht optimiert, bei hoeheren winkeln
    wird das wichtig
  - ausgehend von dem grundlayout koennte man jetzt noch mehr
    optimieren
  - alle abstaende zwischen den linsen variabel
  - numerische apertur hinten auf 0.1 halten (WFNO, oeffnungszahl 4.85
    soll konstant bleiben)
  - merrit spot, mehr strahlen, luftabstaende positiv lassen
  - wird nicht viel besser (mit dieser einzellinse)

* optimierung
  - einfaches beispiel mit zwei variablen, die merritfunktion ist ein
    relief, man kann in der landschaft einen weg suchen um
    runterzukommen
  - wie gross macht man die schritte und in welche richtung?
  - parametervektor \x
  - targetwerte \f(\x)
  - jacobi matrix der ableitungen J_ij = \partial f_i / \partial x_j
  - scalare merrit funktion F(\x) = sum_i=1^m w_i [y_i-f(\x)]^2
  - manchmal nutzt man auch noch die kruemmung (hessematrix) um die
    schrittweite zu optimieren
  - lineares gleichungssystem im aktuellen arbeitspunkt \f = \f_0 + J \x
  - man kann zweite ableitung nehmen um quadratische naeherung der
    merit function zu bekommen
  - ableitungen kann man in der optik nur numerisch ausrechnen
    (frueher mit 7 stellen mantisse war das wichtig, heute nicht mehr
    so kompliziert)
  - in der regel hat man auch randbedingungen. entweder man forder sie
    hart (lagrange multiplier der nebenbedingung exakt erfuellt (fuer
    mathematik in der regel ein problem) oder die merit funktion
    aendern)
  - x1<0 zwingt im bild den algorithmus in ein lokales minimum
  - bereiche: die dicke muss positiv sein, wellenapertur soll kleiner
    als lambda/10 sein
  - weiche forderung: penalty oder barriere functions, dann kann man
    die ableitung bilden
  - abstiegsmethode oder least square (wird in optik verwendet)
  - ungedaempft macht manchmal zu grosse schritte
  - DLS (damped least squares)
  - daempfung oft additiv (verstaerkt die diagonale im
    gleichungssystem)
  - wenn der startwert nichts taugt, taugt auch das ergebnis nicht
  - im optikdesign sehr schmale lange taeler
  - globale verfahren fassen langsam fuss im optik design
  - heutzutage kriegt ein erfahrener designer es schneller hin als ein
    globaler optimierer
  - einzelne ansaetze mag er
  - simulated annealing
  - am anfang mit geometrischen abberationen und fuer das fine tuning
    dann wavefront oder strehl ratio
  - voneinander abhaengige variablen lassen sich nicht optimieren
    (z.b. zwei asphaeren hintereinander)
  - mittlerweile gibt es gut literatur oder patentarchive
  - 40000 patent system in zemax (zu 50% fotoobjektive)
  - radiien wirken extrem empfindlich
  - dicken viel weniger
  - es gibt nur standard radiien (wo man werkzeug fuer hat)
  - glass wahl ist ein riesenproblem
  - randdicken sollen nicht zu klein sein
  - mittendicke soll nicht zu klein sein (dicke zu durchmesser sollte
    nicht kleiner als 1:10 sein)
  - beim zoom lineare nebenbedingung (damit summe der zwei abstaende
    konstant bleibt)
  - konzentrische flaechen vermeiden (wegen reflexen)
  - toleranzunempfindlich korrigieren
  - manager wollen kosten in merit funktion haben (aber das ist schwierig)
  - kosten sind extrem dynamisch (kaum eine firma fertigt alles
    selber, die preise sind nicht vorhersagbar)
  - fertigung will gleichmaessige auslastung machen
  - achromat mit flint vorraus
  - global run dauert lange (z.b. am tag) und dann muss man aus 2700
    system den kaese rausschmeissen, ausserdem muss die merit funktion
    perfekt sein, im beispiel hat er vermeidung duenner und dicker
    linsen abgeschalten
  - glaswahl ist diskret aber springen ist nicht so gut
  - man kann modellglas definieren 
  - umschriebenes polygon nicht verletzen
  - farbkorrektion moechte abbezahl spreizen
  - bildfeldebnung versucht in n zu spreizen
  - diagramm mit bildfehlern fuer sein buch
  - cleverer ansatz: burried surfaces (kit glied, unterschiedliche
    abbezahl aber identische brechzahl, grundfarbe sieht die flaeche
    nicht, nur die farbe wird korrigiert -> entkopplung moeglich)
  - haferkorn illmenau, frueher sehr viel analytische optimierung (in
    praxis nicht wichtig)
  - wenn man an ein optimimum gestossen ist und nicht besser wird,
    dann kann man linse splitten (das hilft in der regel immer)
  - oft macht man null-operationen die das minimum verlaesst, ohne das
    minimum zu zerstaeren (linsen umdrehen, durchbiegen, duenne
    miniskuslinse)
  - es clever die seidelfehler uberall klein zu halten (dann ist es
    toleranzunempfindlich)
  - negativ sollte wie lagrange multiplier wirken
  - bedingungen kombinieren (gewicht 0), differenz zwischen beiden
    soll verschwinden (z.b. zwischen zeilen 17 und 18)
  

* cooke 40 degree
  - system modifizieren fuer 150 mm objekt distanz
  - settings, first surface=0
  - merit funktion aufbauen
    - linsen dicken einschraenken
    - gesamt laenge 210mm, TOTR, objekt abstand mit beruecksichtigen
    - analysis um farben zu trennen
    - gruen auf achse ist beugungsbegrenzt, das andere nicht
    - oeffnung vergroessern
      - rms vs. wavelength -> fernab der beugungsgrenze
      - oeffnung zuziehen bis komplette kurve unter beugungsgrenze
      - bei 7mm beugungsbegrenzt fuer achse und feld fuer alle
        wellenlaengen

* dritte aufgabe: klassischer achromat
  - drei flaechen fuer achromat
  - brennweite EFL 10mm mit merit funktion
  - hide unused column fuer kompaktere darstellung
  - bildseitige NA 0.05
    - general data entweder:
      - image space: f-number oder object cone angle
      - oder einfacher durchmesser ausrechnen mit gegebener brennweite
        und NA
  - materialien BK7 und SF12
  - DIVI division of two operands
    - y/cos(beta) schnittweite vom randstrahl ist momentan 19 
    - fuer paraxial auch nochmal
    - beide schnittweiten sind nur hilfgroessen (benutze gewicht 0)
    - optimiere, dass beide schnittweiten gleich werden
    - longitudinal operation
    - der strahl muss an der bildebene benutzt werden

  - oslo ist billiges raytracer program (gibt kostenlose EDU version)

* imaging and illumination
** definitionen fourier optik
  - ebenes gitter mit monochromatischer planwelle bestrahlen
  - licht geht strukturiert in verschiedene richtungen
  - fourier zerlegung des ausgehenden wellenfeldes in einzelne
    planwellen, die durch strahlen charakterisiert werden
  - transversaler wellenvektor oder winkel theta (geometrisch
    optisch), ortsfrequenz nu (signalverarbeitung)
  - fuer low NA sind obige darstellungen identisch
  - konstruktive interferenz von drei wellen, die durch linse gehen
  - finden gitterkonstante des objekts im bild wieder
  - je mehr ordnung, desto schoener das bild
  - faltungsintegral, falls punktbildfunktion unabhaengig von position
    im feld
  - durchmesser der ersten nullstelle der airy funktion 1.22 lambda /NA
  - duffieux-integral (pupillenformen ueberlappen)
  - absolutwert der OTF ist MTF
  - fuer koheraente bildgebung faltet man amplituden
  - zemax ist zur zeit ziemlich unuebersichtlich in dieser hinsicht
  - partielle koheraenz kann man mit zemax auch machen (seiner ansicht
    nach falsch)
  - im realen system gibt es in der regel keine shift-invarianz
  - isoplanasie (kleines feld, wo annahme einer konstanten psf relativ
    gut erfuellt wird)
  - zwischen psf interpolieren ist nicht so einfach (vermutlich
    interpolieren die die zernicke polynome in der pupille)
  - in code 5 ist es besser geloest (auch partielle kohaerenz)
  - psf-x points (anzahl psf entlang der x achse)
*** demo in zemax
    - double gauss
    - analysis, image simulation
*** weiter lecture
    - radiance ist wichtig (pro winkel)
    - irradiance ist klassische intensitaet
    - photometrische einheiten beziehen sich auf das menschliche auge
    - raumwinkel
    - irradiance ist leistungsdichte an der flaeche, je groesser der
      einfallswinkel, um so weniger hell
    - 1/r^2 und zweimal cosinus fuer sender und empfaenger
    - helmholtz inveriante: feldgroesse * NA ist konstant
    - fuer endlich grosse winkel sinus bedingung
    - wenn man homogene flaeche von der seite anschaut, wird bild
      inhomogen
    - natuerliche vignettierung (projektion, cos^4 des feldwinkels)
    - gruener strahl ist 1/cos laenger
    - cos^4 ist schmerzhaft bei grossen winkeln (fotographie), kann
      man auch kaum verhindern
    - kuenstliche vignettierung (im system)
    - phasenraum (sein spezialgebiet)
    - shack hartmann sensor oder faser braucht nichtsequentielles
      raytrace
    - doppelreflexe koennen oft stoerend wirken (geisterbilder)
    - ihm ist das erste mal nichtsequentielles raytracing begegnet bei
      einem YAG laser
    - doppel elliptische spiegelanordnung
    - moeglichst homogen (am besten mit gauss profil) laser pumpen
    - in zemax:
      - einfach vignettierung im rotationssymmetrischen system rechnen
      - einzelne flaeche als nicht-sequentielle komponente definieren
      - komplett anderer betriebsmodus, dann ist alles anders
        - man brauch z.b. abbruchbedingungen (relative strahlenergie
          oder anzahl interaktionen)
      - deutlich besser als andere programme
        - man kann strahlen akkumulieren (dafuer muss man sagen,
          wieviel strahlen gespeichert bleiben sollen)
*** demo
  - vignetting plot zeigt kuenstliche vignettierung


* beispiel: faser einkoppeln
- achromat, quick focus
- statistisch spot mit 13um durchmesser
- faser mit 4um durchmesser
- analysis footprint -> 27% der strahlen gehen in die faser
- flaechentyp, non-sequential component (faser macht zahl der reflexe
  abhaengig vom eintrittswinkel)
- non-sequential component, typ festlegen auf cylinder light pipe
- ein paar parameter unten eingeben
  - oben: faser soll 20mm lang sein, exit location
  - unten:
    - material aussen verspiegelt (mirror)
    - laenge 20
    - front radius und back radius (halber durchmesser) .002 
- anzeigen im 3D modus
- delete vignette, so dass geblockte strahlen nicht weitergezeichnet
  werden
- erheblich viel mehr strahlen durchschicken
- hinten keine bildebene mit kleinem loch lassen!
- am ende der faser ist es in der mitte hell
- strahlt mit relativ gleichmaessiger winkelverteilung ab
- lichtleiter wirken homogensierend, wenn man mit ihren querschnitt
  die ebene parkettieren kann (rechteck, dreieck oder sechseck aber
  nicht kreis)
- optimierung: general data->non-sequential maximal strahl events
  einstellen, so dass er nicht nach 100 reflexionen aufhoehrt, den
  strahl zu zeichnen

* 6 advanced handling
  - telezentrie
    - hauptstrahl parallel zur optischen achse .. pupille ist im unendlichen
    - im editor muss man eigentlich immer sagen wo die blende liegt
      (da schneidet der hauptstrahl die optische achse)
    - durch diese option 
    - feld als winkel eingeben
  - unendliche objektabstaende
    - astronomie
    - numerische apertur als durchmesser, statt winkel
    - objekt als feldwinkel spezifizieren
    - da kommen dann immer nervige fehlermeldung
    - es kann nicht gleichzeitig telezentrie und objekt im unendlichen sein
  - afokales bild
    - bildraum afokal in General/Apertur
    - aberrationen als winkelstoerungen anschauen (ortsabweichung)
    - oder wellenaberrationen gegen planwelle
    - spot wird automatisch in mrad angezeigt aber man kann auch
      richtungscosinus einstellen
  - koordinatensysteme fuer 3D, umfaltenden spiegel
    - General/Misc
    - global coordinate reference surface (6 .. bildebene)
    - z.b. um entweder von bild oder objekt zu messen
  - scale system
    - Tools/Miscellaneous/Scale
    - aendert verhaeltnis geometrische optik zur wellenoptik
    - Modify/Make focal, skalieren um exakte brennweite zu erreichen
  - umlenkspiegel
    - brauchen eigentlich zwei koordinatentransformationen
    - Tools/Modify/add folding mirror
    - kippung um x-achse um 90 grad, macht danach dicken negativ
  - make double pass .. fuer doppelten durchgang fuer refraktiv
    (interferometer oder reflexe)
    - radien gleiches vorzeichen, dicken negativ
  - vignettierung und durchmesserarten ist komplex
    - durch gekipptes foto objektiv von hinten durchschauen
    - schwerpunkt der flaeche ist der schwere strahl (physikalisch
      wirksamer hauptstrahl)
    - oft (wenn man zwei kreisfoermige linsen hat) bekommt man
      zweiecke
    - surface stop begrenzt in zemax nicht wirklich die apertur,
      sondern definiert nur, wo hauptstrahl opt. achse schneidet
    - float by stop size
    - eins der schwierigsten probleme ist eine linse, die in der mitte
      durchgebohrt ist (praktisch?)
    - optimierung:
      - jeder feldpunkt einzeln schwerstrahl einstellen
      - set vignetting setzt automatisch schwerstrahl und kompression
      - dann werden strahlen automatisch dahin geschickt, wo sie gut durchgehen
  - wie man eigene materialen eingibt und dispersion, koeffizienten
    ausrechnen laesst
    - eigene daten fuer immersionsoele
    - SiO2 mit hoher genauigkeit fuer lithographen
    - herzberger ist eher etwas schlecht
    - sellmeier ist besser
    - Tools/Catalogs/Glass Catalogs
      - zwei optionen: Fit index data, fit melt data
      - bei melt daten sieht man gut die abweichung
      - daten von saphir (nur ordentliche brechzahl) laden, bei fit
        index data sieht man nur globale abweichung
    - man kauft glas mit verschiedenen index qualitaeten (rechteck in
      abbe diagramm)
    - ein einziges mal hat er erlebt, dass zeiss spezielles glas
      bestellt hat, da muss man 2 tonnen bestellen und ein jahr warten
  - report graphics
    - mehrere fenster zusammenstellen
  - universal plot
    - individuelle graphiken ueberlegen 
    - asphaerische einzellinse
    - wellenfront optimierung ist meist schlechter als spot (obwohl
      physikalisch equivalent)
    - Analysis/unversal plot
      - querabweichung vs. asphaerenkonstante
      - optimiere auf strehlzahl
      - oeffnung verkleinern, um an beugungsgrenze zu kommen
      - zweidimensionale optimierung mit asphaerenkonstanten auf
        beiden seiten
  - mit slider einzelne parameter aendern .. nette spielerei
    - Tools/Design
    - -1e-6 .. 0
  - visuelle optimierung .. mag er nicht
    - macht eher sinn fuer zoom system
  - daten rausholen
    - mit window textfenster aufmachen
    - anzahl der stellen kann offenbar nicht angepasst werden
    - CAD daten in STEP oder IGES exportieren
      - auch mit strahlen
      - designer kann dann die mechanik um die optik basteln
      - zoom wird als einige positionen uebergeben
  - multikonfiguration .. mehrer system typen gleichzeitig betrachten
    - das ist sehr nuetzlich
    - system in mehreren zustaenden unterscheiden
    - mit Strg-A umherspringen
    - scan-systeme oder zoom-systeme
    - tauschsystem
    - interferometer -> test-arm
    - fuer brennweiten 1, 2 und 5 gleichzeitig optimieren
    - trauriger fall, wo zoom system gebaut wurde was hinten vorne und
      in der mitte funktioniert aber nicht dazwischen
    - einfaches zoom, mit nur einer beweglichen linse
      - 5 konfigurationen
      - 0, 25, 50, 75, 100, linse von ganz links nach ganz rechts
      - konfiguration matrix, alle spots nebeneinander darstellen
      - 3d schnitt mit allen konfigurationen darstellen und in y
        auseinanderziehen (manager konform), das ist ganz gut geloest
      - merit funktion fuer alle stellungen gleichzeitig
      - offenbar kann man keine gewichte zu einzelnen konfigurationen
        zuordnen
      - interferogram mit zwei konfigurationen, sehr schoen
        - ziemlich schwierig einzugeben, in einer konfiguration
          reflexion im anderen transmission
        - mit slider fokussieren auf kleinste ringzahl
  - fasern mit einigen moden geht gar nicht
    - entweder rein geometrisch
    - oder spezialmenu fuer monomode faser LP00 mode
    - psf in bildebene mit klassischem beugungsintegral und ueberlapp
      der komplexen felder (physikalisch korrekt)
    - im POP kann man auch winkelabhaengige fresnelkoeffizienten der
      reflexion benutzen (36% vs 29%)
  - macro sprache .. nicht besonders schoen, aber es geht
    - kaum moeglichkeit zum debuggen
    - zernicke polynome, viele parameter fuer funktionen
    - graphischer output primitiv
    - normalerweise exportiert er alle daten in datei und benutzt dann
      matlab
    - man kann parameter wackeln
    - keneth moore war einer der wegbereiter von zemax
      - beispiel, um schwerpunkt zu bestimmen
      - sieht alles aus wie fortran
      - er benutzt sie sehr viel und es macht wenig spass, wenn man
        fehler drin hat
  - DLL
    - user defined surfaces sind moeglich
    - C oder C++ routine als DLL
    - schnittstelle ist nicht schoen dokumentiert
    - relativ schnell
    - sie hatten mal beispiele, da machte das sinn
    - freiform flaechen oder facettierte flaechen
  - matlab (macht er standardmaessig immer)
    - leider hat zemax keine com schnittstelle (da warten eigentlich
      alle drauf)
    - gut programmierte toolbox
    - direktprogrammkopplung
    - funktioniert nicht immer
    - matlab weiss nicht, wenn zemax fertig ist
    - mit 64bit gehts irgendwie nicht mehr
